<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html>
  <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Select Build Demo</title>
        <link
            rel="stylesheet"
            href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/10.0.0/css/fabric.min.css"
        />

        <style>
            .dropbtn {
              background-color: #afafaf;
              color: #fafafa;
              padding: 5px;
              font-size: 16px;
              border: none;
              cursor: pointer;
              width: 200px;
            }
            
            .dropbtn:hover, .dropbtn:focus {
              background-color: #5f5f5f;
            }
            
            #myInput {
              box-sizing: border-box;
              background-image: url('searchicon.png');
              background-position: 14px 12px;
              background-repeat: no-repeat;
              font-size: 16px;
              padding: 14px 20px 12px 45px;
              border: none;
              border-bottom: 1px solid #ddd;
            }
            
            #myInput:focus {outline: 3px solid #ddd;}
            
            .dropdown {
                margin: 10px 0;
              position: relative;
              display: inline-block;
            }
            
            .dropdown-content {
              display: none;
              position: absolute;
              background-color: #f6f6f6;
              min-width: 230px;
              border: 1px solid #ddd;
              z-index: 1;
              
            }

            .dropdown-items {
                overflow: auto;
                max-height: 400px;
            }
            
            .dropdown-content a {
              color: black;
              padding: 12px 16px;
              text-decoration: none;
              display: block;
            }
            
            .dropdown a:hover {background-color: #ddd;}
            
            .show {display: block;}
        </style>
    </head>

  <body class="ms-font-m ms-welcome ms-Fabric">
    <header class="ms-welcome__header ms-bgColor-neutralLighter">
      <h3 class="ms-font-l">Select Build Demo</h3>
    </header>
    <div>
        <div class="dropdown">
            <div>
                <button id="build-button" onclick="toggleDropdownPanel('build-button', 'build-dropdown', 'Build')" class="dropbtn">Open Build Dropdown</button>
                <span id="selected-build-item">Selected Item: </span>
            </div>
            <div id="build-dropdown" class="dropdown-content">
                <input type="text" placeholder="Search.." id="build-input" onkeyup="filterBuildItems('build-input', 'build-dropdown')">
                <div id="items-container" class="dropdown-items">
                    
                </div>
                
            </div>
        </div>
    </div>

    <div>
        <div class="dropdown">

            <button id="config-button" onclick="toggleDropdownPanel('config-button', 'config-dropdown', 'Config')" class="dropbtn">Open Config Dropdown</button>
            <span id="selected-config-item">Selected Item: </span>

            <div id="config-dropdown" class="dropdown-content">
                <div id="items-container" class="dropdown-items">
                    <a onClick="selectConfigItem('backend-staging')"  href="#base">backend-staging</a>
                    <a onClick="selectConfigItem('dev')"  href="#">dev</a>
                    <a onClick="selectConfigItem('test')" href="#">test</a>
                    <a onClick="selectConfigItem('prod')" href="#">prod</a>
                    <a onClick="selectConfigItem('test-officejsbeta')"  href="#">test-officejsbeta</a>
                </div>
                
            </div>
        </div>
    </div>
      <script>
        const items = [
            'mail-responder-17007-pr-2583',
            'admin-center-17007-pr-2583',
            'mail-signature-editor-17007-pr-2583',
            'office-addins-16985-pr-2598',
            'office-addins-16985-pr-1231',
            'office-addins-16985-pr-1232',
            'office-addins-16985-pr-1233',
            'office-addins-16985-pr-1234',
            'office-addins-16985-pr-1235',
            'office-addins-16985-pr-1236',
            'office-addins-16985-pr-1237',
            'office-addins-16985-pr-1238',
            'office-addins-16985-pr-1239',
            'office-addins-16985-pr-1240',
            'office-addins-16985-pr-1241',
            'office-addins-16985-pr-1242',
            'office-addins-16985-pr-1243',
            'office-addins-16985-pr-1244',
            'office-addins-16985-pr-1245',
            'office-addins-16985-pr-1246',
            'office-addins-16985-pr-1247',
            'office-addins-16985-pr-1248',
            'office-addins-16985-pr-1249',
            'office-addins-16985-pr-1250',
            'office-addins-16985-pr-1251',
            'office-addins-16985-pr-1252',
            'office-addins-16985-pr-1253',
            'office-addins-16985-pr-1254',
            'office-addins-16985-pr-1255',
            'office-addins-16985-pr-1256',
            'office-addins-16985-pr-1257',
            'office-addins-16985-pr-1258',
            'office-addins-16985-pr-1259',
            'office-addins-16985-pr-1260',
            'office-addins-16985-pr-1261',
            'office-addins-16985-pr-1262',
            'office-addins-16985-pr-1263',
            'office-addins-16985-pr-1264',
            'office-addins-16985-pr-1265',
            'office-addins-16985-pr-1266',
            'office-addins-16985-pr-1267',
            'office-addins-16985-pr-1268',
            'office-addins-16985-pr-1269',
        ];

        const buildContainer = document.getElementById('items-container');

        items.forEach((name) => {
                    const childNode = document.createElement("a");
                    childNode.href = '#';
                    childNode.innerHTML = name;
                    childNode.onclick = () => selectBuildItem(name);
                    buildContainer.append(childNode);
                });


        function toggleDropdownPanel(buttonId, dropDownId, type) {
            const ele = document.getElementById(dropDownId);
            ele.classList.contains('show') ? hideDropdownPanel(buttonId, dropDownId, type) : showDropdownPanel(buttonId, dropDownId, type);
        }

        function showDropdownPanel(buttonId, dropDownId, type) {
            document.getElementById(buttonId).innerHTML = `Close ${type} Dropdown`;
            document.getElementById(dropDownId).classList.add('show');
        }

        function hideDropdownPanel(buttonId, dropDownId, type) {
            document.getElementById(buttonId).innerHTML = `Open ${type} Dropdown`;
            document.getElementById(dropDownId).classList.remove('show');
        }

        function selectBuildItem(selectedId) {
            const selectedItemEle = document.getElementById('selected-build-item');

            selectedItemEle.innerHTML = `Selected Item: ${selectedId}`;

            hideDropdownPanel('build-button', 'build-dropdown', 'Build');
        }

        function selectConfigItem(selectedId) {
            const selectedItemEle = document.getElementById('selected-config-item');

            selectedItemEle.innerHTML = `Selected Item: ${selectedId}`;

            hideDropdownPanel('config-button', 'config-dropdown', 'Config');
        }

        function filterBuildItems(inputId, containerId) {
            const input = document.getElementById('build-input');

            const filterText = input.value.toLowerCase();

            const container = document.getElementById('items-container');

            const items = container.getElementsByTagName("a");

            for(let item of items) {
                const itemValue = (item.textContent || item.innerText).toLowerCase();

                const displayItem = itemValue.includes(filterText);

                item.style.display = displayItem ? "auto" : "none";
            }
        }

        </script>
  </body>
</html>